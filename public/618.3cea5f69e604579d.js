"use strict";(self.webpackChunktp_final_labo=self.webpackChunktp_final_labo||[]).push([[618],{2618:(S,h,l)=>{l.r(h),l.d(h,{RegisterComponent:()=>E});var m=l(5861),o=l(433),p=l(6895),v=l(1746),w=l(9803),d=l(6557),y=l(4132);class u{static onlyLetters(i){const t=i.value;return/^([^\u0000-\u0040\u005B-\u0060\u007B-\u00BF\u02B0-\u036F\u00D7\u00F7\u2000-\u2BFF])+$/.test(t)||!t?null:{onlyLetters:!0}}static lettersAndNumbers(i){const t=i.value;return/^[A-z0-9\xc1-\xfc]+$/.test(t)||!t?null:{lettersAndNumbers:!0}}static onlyNumbers(i){const t=i.value;return/^[0-9]+$/.test(t)||!t?null:{onlyNumbers:!0}}static email(i){const t=i.value;return/^[aA0-zZ9]+@[aA-zZ]+.[aA-zZ]{2,3}(.[aA-zZ]{2,3})?$/.test(t)||!t?null:{email:!0}}static password(i){const t=i.value,a=i.parent?.get("confirmPassword");return a?.setErrors(a?.value===t?null:{confirmPassword:!0}),/^(?=.*[0-9])(?=.*[a-z])(?=.*[A-Z])(?=.*[a-zA-Z]).{8,}$/.test(t)||!t?null:{password:!0}}static confirmPassword(i){const r=i.parent?.value.password;return i.value===r?null:{confirmPassword:!0}}static obraSocial(i){const t=i.value;return/^(1-[0-9]{4}-[0-9])$/.test(t)||!t?null:{obraSocial:!0}}}var Z=l(7931),e=l(8256),b=l(3071),c=l(8032);let _=(()=>{class s{constructor(t){this.storage=t}addImage(t,r){var a=this;return(0,m.Z)(function*(){const n=(0,c.iH)(a.storage,`images/${r}/${t.name}`);return(0,c.KV)(n,t).then(function(){var g=(0,m.Z)(function*(f){return yield(0,c.Jt)(f.ref)});return function(f){return g.apply(this,arguments)}}())})()}getImages(){const t=(0,c.iH)(this.storage,"images");return(0,c.aF)(t)}getImage(t){return(0,c.iH)(this.storage,`images/${t}`)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(c.Ke))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();var N=l(7185);function T(s,i){if(1&s){const t=e.EpF();e.TgZ(0,"div",7)(1,"div",46)(2,"app-alert",47),e.NdJ("hideAlertEvent",function(a){e.CHM(t);const n=e.oxw();return e.KtG(n.showAlert=a)}),e.qZA()()()}if(2&s){const t=e.oxw();e.xp6(2),e.Q6J("text",t.textError||"Error, algo salio mal")}}function x(s,i){1&s&&(e.TgZ(0,"option",11),e._uU(1,"Administrador"),e.qZA()),2&s&&e.Q6J("value",1)}function A(s,i){1&s&&(e.TgZ(0,"small",15),e._uU(1,"Ingresa 2 imagenes"),e.qZA())}function I(s,i){if(1&s&&(e.TgZ(0,"div",29)(1,"app-form-input",48)(2,"small",15),e._uU(3,"Ingrese un formato valido: 1-xxxx-x"),e.qZA()()()),2&s){const t=e.oxw();e.xp6(1),e.Tol(t.obraSocial.errors?"is-invalid":"")}}function R(s,i){if(1&s&&(e.TgZ(0,"option",11),e._uU(1),e.qZA()),2&s){const t=i.$implicit;e.Q6J("value",t.name),e.xp6(1),e.hij(" ",t.name," ")}}function C(s,i){if(1&s){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",49)(2,"div",50)(3,"select",51),e.YNc(4,R,2,2,"option",52),e.qZA(),e.TgZ(5,"label",53),e._uU(6,"Especialidad"),e.qZA()()(),e.TgZ(7,"div",54)(8,"button",55),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.showModal=!0)}),e._uU(9," Agregar "),e.qZA()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Gre("form-select mb-2 text-capitalize ",t.especialidad.errors?"is-invalid":"",""),e.xp6(1),e.Q6J("ngForOf",t.especialidades)}}let E=(()=>{class s{constructor(t,r,a,n){this.userService=t,this.router=r,this.imgService=a,this.toastr=n,this.loading=!1,this.showAlert=!1,this.showModal=!1,this.formReg=new o.cw({type:new o.NI(""),name:new o.NI("",[u.onlyLetters]),lastName:new o.NI("",[u.onlyLetters]),dni:new o.NI(null,[o.kI.maxLength(8),o.kI.minLength(8),u.onlyNumbers]),age:new o.NI("",[o.kI.min(18),o.kI.max(65),u.onlyNumbers]),email:new o.NI("",[u.email]),password:new o.NI("",[u.password,o.kI.minLength(8)]),confirmPassword:new o.NI("",[u.confirmPassword]),images:new o.NI,showPassword:new o.NI}),this.formEsp=new o.cw({espName:new o.NI("",[u.onlyLetters])})}ngOnInit(){this.user=this.userService.getCurrentUser(),this.userService.getSpecialties().subscribe(t=>{this.especialidades=t})}onSubmit(){var t=this;return(0,m.Z)(function*(){t.verifyValues(),!t.formReg.invalid&&(t.loading=!0,t.userService.register(t.formReg.value).then(r=>{t.addToFirestore(r.user)}).catch(r=>{t.showAlert=!0,t.loading=!1,t.textError="Error, no se pudo registrar al usuario","auth/email-already-in-use"===r.code&&(t.textError="El correo ya se encuentra en uso"),"auth/network-request-failed"===r.code&&(t.textError="Se perdi\xf3 la conexion a internet")}))})()}addToFirestore(t){var r=this;return(0,m.Z)(function*(){const a=[];for(let n=0;n<r.imgUploaded.length;n++){const g=yield r.imgService.addImage(r.imgUploaded[n],t.uid);a.push(g),n===r.imgUploaded.length-1&&r.userService.addUserById({...r.formReg.value,imgURLs:a},t.uid).then(f=>{r.postAddToFirestore(t)})}})()}postAddToFirestore(t){"2"===this.type.value||"3"===this.type.value?(this.toastr.info("Le enviamos un correo para su verificacion","Verificar Email"),this.userService.sendEmailVerification(t)):this.toastr.success("El usuario se cre\xf3 exitosamente","Usuario creado"),this.formReg.reset(),this.loading=!1,this.router.navigate(["/bienvenido"])}selectTypeUser(t){switch(t.target.value){case"2":this.formReg.addControl("especialidad",new o.NI),this.formReg.controls.obraSocial&&this.formReg.removeControl("obraSocial");break;case"3":this.formReg.addControl("obraSocial",new o.NI("",u.obraSocial)),this.formReg.controls.especialidad&&this.formReg.removeControl("especialidad")}}selectImages(t){console.log(t.target.files),this.imgUploaded=t.target.files,this.imgUploaded.length>2&&this.images.setErrors({images:!0})}createSpecialty(){this.loading=!0,this.userService.addSpecialty({name:this.espName.value}).then(t=>{console.log(t),this.showModal=!1,this.loading=!1,this.formEsp.reset()})}cancelSpecialtyCreation(){this.showModal=!1,this.formEsp.reset()}verifyValues(){this.email.value||this.email.setErrors({email:!0}),this.password.value||this.password.setErrors({password:!0}),this.confirmPassword.value||this.confirmPassword.setErrors({confirmPassword:!0}),this.type.value||this.type.setErrors({type:!0}),this.name.value||this.name.setErrors({name:!0}),this.lastName.value||this.lastName.setErrors({lastName:!0}),this.dni.value||this.dni.setErrors({dni:!0}),this.age.value||this.age.setErrors({age:!0}),this.obraSocial&&!this.obraSocial.value&&this.obraSocial.setErrors({obraSocial:!0}),this.especialidad&&!this.especialidad.value&&this.especialidad.setErrors({especialidad:!0}),this.images.value||this.images.setErrors({images:!0})}get type(){return this.formReg.controls.type}get name(){return this.formReg.controls.name}get lastName(){return this.formReg.controls.lastName}get dni(){return this.formReg.controls.dni}get age(){return this.formReg.controls.age}get obraSocial(){return this.formReg.controls.obraSocial}get especialidad(){return this.formReg.controls.especialidad}get email(){return this.formReg.controls.email}get password(){return this.formReg.controls.password}get confirmPassword(){return this.formReg.controls.confirmPassword}get images(){return this.formReg.controls.images}get showPassword(){return this.formReg.controls.showPassword}get espName(){return this.formEsp.controls.espName}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(b.K),e.Y36(d.F0),e.Y36(_),e.Y36(N._W))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-register"]],standalone:!0,features:[e.jDz],decls:75,vars:45,consts:[[1,"container-fluid","content","h-100","px-1","py-3"],["routerLink","/bienvenido"],[1,"fa-solid","fa-arrow-left","position-absolute","top-0","start-0","m-4","fs-3","color-tertiary"],[1,"container",3,"formGroup","ngSubmit"],[1,"row","justify-content-center","mb-2"],[1,"col-12","text-center","color-tertiary"],["class","row justify-content-center",4,"ngIf"],[1,"row","justify-content-center"],[1,"col-10","p-0","form-floating"],["formControlName","type","id","selectUser",3,"change"],[3,"value",4,"ngIf"],[3,"value"],["for","selectUser"],[1,"col-10","col-sm-5","p-0"],["controlName","name","label","Nombre","type","text"],[1,"invalid-feedback","fw-bold"],[1,"col-10","col-sm-5","p-0","ps-sm-2"],["controlName","lastName","label","Apellido","type","text"],[1,"col-10","col-sm-4","p-0"],["controlName","dni","label","DNI","type","text"],[1,"col-5","col-sm-2","p-0","ps-sm-2"],["controlName","age","label","Edad","type","text"],[1,"col-5","col-sm-4","p-0","ps-2"],[1,"form-floating","mb-2"],["type","file","formControlName","images","id","img-input",3,"multiple","change"],["for","img-input"],["class","invalid-feedback fw-bold",4,"ngIf"],["class","col-10 p-0",4,"ngIf"],[4,"ngIf"],[1,"col-10","p-0"],["controlName","email","label","Correo Electr\xf3nico","type","text"],["controlName","password","label","Contrase\xf1a",3,"type"],["controlName","confirmPassword","label","Confirmar Constrase\xf1a",3,"type"],[1,"col-10","form-check","form-switch","mb-2"],["formControlName","showPassword","type","checkbox","role","switch","id","flexSwitchCheckChecked","checked","",1,"form-check-input"],["for","flexSwitchCheckChecked",1,"form-check-label"],[1,"col-12","d-flex","justify-content-center"],["expand","block","shape","round","type","submit",1,"btn","bg-color-primary","text-light"],[3,"showSpinner"],[3,"showModal","hideModalEvent"],[1,"fw-bold"],[3,"formGroup","submit"],["controlName","espName","label","Especialidad","type","text"],[1,"d-flex","gap-2","justify-content-center"],["type","submit",1,"btn","btn-primary"],["type","button",1,"btn","btn-danger",3,"click"],[1,"col-12","text-white"],[3,"text","hideAlertEvent"],["controlName","obraSocial","label","Nro de Obra Social","type","text"],[1,"col-6","col-sm-8","p-0"],[1,"form-floating"],["formControlName","especialidad","id","selectProfession"],[3,"value",4,"ngFor","ngForOf"],["for","selectProfession"],[1,"col-4","col-sm-2","p-0","ps-2","pb-3"],["type","button",1,"btn","bg-color-tertiary","w-100","h-100",3,"click"]],template:function(t,r){1&t&&(e.TgZ(0,"div",0)(1,"a",1),e._UZ(2,"i",2),e.qZA(),e.TgZ(3,"form",3),e.NdJ("ngSubmit",function(){return r.onSubmit()}),e.TgZ(4,"div",4)(5,"div",5)(6,"h1"),e._uU(7,"Registrarme"),e.qZA()()(),e.YNc(8,T,3,1,"div",6),e.TgZ(9,"div",7)(10,"div",8)(11,"select",9),e.NdJ("change",function(n){return r.selectTypeUser(n)}),e.YNc(12,x,2,1,"option",10),e.TgZ(13,"option",11),e._uU(14,"Especialista"),e.qZA(),e.TgZ(15,"option",11),e._uU(16,"Paciente"),e.qZA()(),e.TgZ(17,"label",12),e._uU(18,"Tipo Usuario"),e.qZA()(),e.TgZ(19,"div",13)(20,"app-form-input",14)(21,"small",15),e._uU(22,"Ingrese solo letras"),e.qZA()()(),e.TgZ(23,"div",16)(24,"app-form-input",17)(25,"small",15),e._uU(26,"Ingrese solo letras"),e.qZA()()(),e.TgZ(27,"div",18)(28,"app-form-input",19)(29,"small",15),e._uU(30,"Ingrese solo numeros"),e.qZA()()(),e.TgZ(31,"div",20)(32,"app-form-input",21)(33,"small",15),e._uU(34,"Entre 18 - 65"),e.qZA()()(),e.TgZ(35,"div",22)(36,"div",23)(37,"input",24),e.NdJ("change",function(n){return r.selectImages(n)}),e.qZA(),e.TgZ(38,"label",25),e._uU(39),e.qZA(),e.YNc(40,A,2,0,"small",26),e.qZA()(),e.YNc(41,I,4,3,"div",27),e.YNc(42,C,10,4,"ng-container",28),e.TgZ(43,"div",29)(44,"app-form-input",30)(45,"small",15),e._uU(46,"Ingrese un email valido"),e.qZA()()(),e.TgZ(47,"div",13)(48,"app-form-input",31)(49,"small",15),e._uU(50,"Minimo 1: mayus, minus, numero"),e.qZA()()(),e.TgZ(51,"div",16)(52,"app-form-input",32)(53,"small",15),e._uU(54,"Debe coincidir con la contrase\xf1a"),e.qZA()()(),e.TgZ(55,"div",33),e._UZ(56,"input",34),e.TgZ(57,"label",35),e._uU(58,"Mostrar Contrase\xf1a"),e.qZA()(),e.TgZ(59,"div",36)(60,"button",37),e._uU(61," Crear cuenta "),e.qZA()()()()(),e._UZ(62,"app-spinner",38),e.TgZ(63,"app-modal-custom",39),e.NdJ("hideModalEvent",function(n){return r.showModal=n}),e.TgZ(64,"p",40),e._uU(65,"Nueva Especialidad"),e.qZA(),e.TgZ(66,"form",41),e.NdJ("submit",function(){return r.createSpecialty()}),e.TgZ(67,"app-form-input",42)(68,"small",15),e._uU(69,"Ingrese solo letras"),e.qZA()(),e.TgZ(70,"div",43)(71,"button",44),e._uU(72," Crear "),e.qZA(),e.TgZ(73,"button",45),e.NdJ("click",function(){return r.cancelSpecialtyCreation()}),e._uU(74," Cancelar "),e.qZA()()()()),2&t&&(e.xp6(3),e.Q6J("formGroup",r.formReg),e.xp6(5),e.Q6J("ngIf",r.showAlert),e.xp6(3),e.Gre("form-select mb-2 ",r.type.errors?"is-invalid":"",""),e.xp6(1),e.Q6J("ngIf",1===(null==r.user?null:r.user.type)),e.xp6(1),e.Q6J("value",2),e.xp6(2),e.Q6J("value",3),e.xp6(5),e.Tol(r.name.errors?"is-invalid":""),e.xp6(4),e.Tol(r.lastName.errors?"is-invalid":""),e.xp6(4),e.Tol(r.dni.errors?"is-invalid":""),e.xp6(4),e.Tol(r.age.errors?"is-invalid":""),e.xp6(5),e.Gre("form-control ",r.images.errors?"is-invalid":"",""),e.Q6J("multiple","2"===r.type.value),e.xp6(2),e.Oqu("2"===r.type.value?"Imagenes":"Imagen"),e.xp6(1),e.Q6J("ngIf","2"===r.type.value),e.xp6(1),e.Q6J("ngIf","3"===r.type.value),e.xp6(1),e.Q6J("ngIf","2"===r.type.value),e.xp6(2),e.Tol(r.email.errors?"is-invalid":""),e.xp6(4),e.Tol(r.password.errors?"is-invalid":""),e.Q6J("type",r.showPassword.value?"text":"password"),e.xp6(4),e.Tol(r.confirmPassword.errors?"is-invalid":""),e.Q6J("type",r.showPassword.value?"text":"password"),e.xp6(10),e.Q6J("showSpinner",r.loading),e.xp6(1),e.Q6J("showModal",r.showModal),e.xp6(3),e.Q6J("formGroup",r.formEsp),e.xp6(1),e.Tol(r.espName.errors?"is-invalid":""))},dependencies:[p.ez,p.sg,p.O5,v.s,w.w,o.u5,o._Y,o.YN,o.Kr,o.Fj,o.Wl,o.EJ,o.JJ,o.JL,d.Bz,d.rH,o.UX,o.sg,o.u,y.O,Z.H],styles:[".content[_ngcontent-%COMP%]{width:100%;min-height:100vh;display:flex;justify-content:center;align-items:center}form[_ngcontent-%COMP%]{max-width:750px}"]}),s})()}}]);